# 🏠 스마트 환경 모니터링 시스템 (Arduino + Node-RED + 공공 API)

> **실시간 IoT 기반 실내 환경 모니터링 및 날씨 기반 추천 시스템**

---

## 📌 프로젝트 개요

이 프로젝트는 ESP32(Arduino), 온습도 센서(DHT11), 가스 센서, PIR 센서를 활용하여 실내 환경을 실시간으로 모니터링하고, Node-RED 대시보드를 통해 시각화하며, 공공 API(KMA)를 통해 외부 날씨 정보를 수집하여 옷차림/우산 추천까지 제공하는 스마트 IoT 시스템입니다.

* **마이크로컨트롤러**: ESP32 (Arduino 코드 기반)
* **시각화 도구**: Node-RED Dashboard
* **날씨 API 연동**: 기상청 KMA OpenAPI
* **통신 방식**: UART 시리얼 통신 (+ 향후 MQTT 확장 고려)

---

## 🛠️ 주요 기능 요약

| 기능                  | 설명                                      |
| ------------------- | --------------------------------------- |
| 🌡️ 실내 센서 정보 실시간 수집 | 온도, 습도(DHT11), 가스농도(Analog), 모션(PIR) 감지 |
| 📊 Node-RED 기반 대시보드 | 게이지/차트 시각화 + 텍스트 경고 메시지 출력              |
| 🧥 날씨 기반 옷차림 추천     | 기온에 따라 계절별 적정 옷차림 텍스트 출력                |
| ☂️ 우산 추천            | 강수 확률 분석 기반 우산 챙김 여부 안내                 |
| 🚨 실내 경고 시스템        | 가스 경보, 온습도 이상 탐지, 모션 감지 시 LED 점등        |

---

## 🖼️ 시스템 아키텍처

![시스템 아키텍처](https://i.ibb.co/bj5SKfsk/system-architecture.png)

---

---

## 🖼️ GUI 아키텍처

![GUI 아키텍처](https://i.ibb.co/XkG6SnJn/nodered-architecture.png)

---


## 🎮 시연 영상 (Demo)

![구동 예시 GIF](https://your-link.com/demo.gif)

---

## 🔌 하드웨어 구성

| 센서/모듈       | 핀(GPIO)      | 설명            |
| ----------- | ------------ | ------------- |
| DHT11 (온습도) | D2 (GPIO 26) | 디지털 입력        |
| 가스 센서       | D3 (GPIO 32) | 아날로그 입력       |
| PIR 센서      | D0 (GPIO 2)  | 모션 감지용 디지털 입력 |
| LED         | D1 (GPIO 15) | 출력용 표시장치      |

---

## 💻 소프트웨어 구성

### 📟 Arduino 코드 (ESP32)

* 온습도, 가스, 모션 데이터를 시리얼로 전송 (CSV 형식)
* 모션 감지 시 LED 점등 (1회 On/Off)

### 🔄 Node-RED 플로우

* `serial in` → `Function node` → 센서 분리 및 파싱 → 대시보드 시각화
* 기상청 API 호출(단기예보 - 초단기실황): `http request`
* 옷차림/우산 추천, 실내 상태 텍스트 출력 (Function 노드로 구현)

### 📊 Node-RED 대시보드 UI

* 실내 온습도, 가스: 게이지 출력
* 모션 감지: 실시간 라인차트
* 외부 날씨: 온도/습도/풍속/강수형태 출력
* 추천 항목: 옷차림, 온도/습도 조절 안내, 가스 상태 메시지

---

## 🔗 외부 API 연동 (기상청)

기상청 OpenAPI 사용:

* `getUltraSrtNcst`: 초단기 실황
* `getVilageFcst`: 중기 예보

사용자 위치 (예: 수원시 팔달구)에 맞춰 API 호출 및 시간 형식 변환 포함

---

## 🚨 알림 및 제어 로직

| 센서      | 조건            | 메시지            |
| ------- | ------------- | -------------- |
| 온도 (겨울) | <18도 / >21도   | 난방 조절 안내       |
| 습도 (여름) | <55% / >65%   | 가습기/제습기 안내     |
| 가스 농도   | >1000 / >3000 | 환기 또는 가스 누출 경고 |
| 모션      | 감지 시          | 차트 출력, LED 제어  |

---

## 📁 프로젝트 파일 구조

* `sense-arduino.ino` - 아두이노 센서 데이터 송신 코드
* `node-red-flow.json` - Node-RED 플로우 전체 구조
* `README.md` - 본 설명 파일

---

## 📸 시연 이미지

* 데모 GIF 1: ![Demo](./gifs/1.gif)
* 데모 GIF 2: ![Demo](./gifs/2.gif)


---

## 🧩 향후 개발 계획

* MQTT 전환을 통한 클라우드 기반 연동 확장
* 모션 데이터 기반 간단한 행동 분류 AI 도입
* Raspberry Pi 연동 및 로컬 DB 저장 기능 추가